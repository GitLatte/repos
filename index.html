<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <title>CloudStream Eklenti Listesi</title>
    <style>
        body { 
    font-family: Arial, sans-serif; 
    margin: 20px; 
    background-color: #f5f5f5; 
    text-align: center; 
}

.plugin-status-badge {
    display: inline-block;
    font-size: 10px;
    padding: 3px 6px;
    border-radius: 4px;
    margin-left: 5px;
    color: white;
    font-weight: bold;
    vertical-align: middle;
}

.new-plugin-badge {
    background-color: #28a745; /* Yeşil */
}

.updated-plugin-badge {
    background-color: #ffc107; /* Sarı */
    color: #333; /* Sarı üzerinde daha iyi görünmesi için koyu yazı */
}
h2 { color: #333; }

.stats { 
    font-size: 18px; 
    font-weight: bold; 
    margin-bottom: 10px; 
}

.filter-container { margin-bottom: 10px; }
select, input { 
    padding: 6px; 
    font-size: 14px; 
    border-radius: 4px; 
    border: 1px solid #ccc; 
    margin: 4px; 
}
button { 
    padding: 6px; 
    font-size: 14px; 
    border-radius: 4px; 
    background: #007BFF; 
    color: white; 
    border: none; 
    cursor: pointer; 
    transition: 0.3s ease; 
}
button:hover { background: #0056b3; }

/* Tablo için şık ve modern tasarım */
table { 
    width: 95%; 
    border-collapse: separate; 
    border-spacing: 0; 
    margin: auto; 
    background: white; 
    border-radius: 10px; 
    overflow: hidden; 
    border: 2px solid #007BFF; /* Tablo kenarlığını belirginleştirdik */
    box-shadow: 0px 4px 10px rgba(0, 0, 0, 0.1); /* Hafif gölge ekledik */
}

th, td { 
    border: 1px solid #ccc; 
    padding: 10px; 
    text-align: left; 
    font-size: 14px; 
}
th { 
    background-color: #007BFF; 
    color: white; 
    font-size: 15px; 
    border-bottom: 2px solid #0056b3; /* Daha belirgin alt kenar */
}
tr:hover { 
    background-color: #f9f9f9; /* Hover efekti biraz daha yumuşak */
    transition: 0.2s ease-in-out;
}

.bold { font-weight: bold; }
.desc { font-size: 12px; color: #555; }

/* Depo kodları için renkli badge */
.repo-badge {
    display: inline-block;
    font-size: 12px;
    padding: 5px 8px;
    border-radius: 6px;
    margin-right: 4px;
    color: white;
    font-weight: bold;
    box-shadow: 0px 2px 4px rgba(0, 0, 0, 0.2); /* Hafif gölge */
}

/* Her repo için özel renkler */
.repo-sinetech { background-color: #FF5733; }  /* Turuncu */
.repo-nikstream { background-color: #33B5E5; } /* Mavi */
.repo-feroxxcs3 { background-color: #FF9800; } /* Açık Turuncu */
.repo-makoto { background-color: #4CAF50; }  /* Yeşil */
.repo-kekikdevam { background-color: #673AB7; } /* Mor */
.repo-kekikan { background-color: #E91E63; } /* Pembe */
.repo-sarapcanagii { background-color: #607D8B; } /* Gri */

/* Ana başlığı şık hale getirme */
.header-title {
    font-size: 28px;
    font-weight: bold;
    color: #007BFF;
    text-align: center;
    margin-bottom: 20px;
    text-shadow: 2px 2px 6px rgba(0, 0, 0, 0.15);
}

/* İstatistikler için özel kart tasarımı */
.stats-container {
    display: flex;
    justify-content: center;
    gap: 15px;
    margin-bottom: 20px;
}

.stats-card {
    background-color: #ffffff;
    padding: 12px 20px;
    border-radius: 8px;
    border: 2px solid #007BFF;
    box-shadow: 0px 4px 8px rgba(0, 0, 0, 0.1);
    font-size: 16px;
    font-weight: bold;
    color: #333;
    min-width: 240px;
    text-align: center;
    transition: 0.3s ease-in-out;
}

.stats-card:hover {
    background-color: #007BFF;
    color: white;
    transform: scale(1.05);
}

    </style>    
</head>
<body>
    <h2 class="header-title">CS TR Eklenti ve Depo Listesi</h2>

    <div class="stats-container">
        <div class="stats-card"><span id="totalPlugins">Toplam Eklenti: 0</span></div>
        <div class="stats-card"><span id="totalRepos">Toplam Depo: 0</span></div>
        <div class="stats-card"><span id="lastUpdated">Son Güncelleme: Bilinmiyor</span></div>
    </div>  

    <div class="filter-container">
        <label for="filterSelect">Medya Türü Seç:</label>
        <select id="filterSelect">
            <option value="all">Tüm Eklentiler</option>
        </select>

        <label for="repoFilterSelect">Depo Seç:</label>
        <select id="repoFilterSelect">
            <option value="all">Tüm Depolar</option>
        </select>
    </div>

    <div class="filter-container">
        <input type="text" id="searchInput" placeholder="Eklenti Ara...">
        <button id="clearSearch">Temizle</button>
    </div>

    <style>
    /* Sıralanabilir tablo başlıkları için stil */
    th.sortable {
        cursor: pointer;
        position: relative;
        padding-right: 20px; /* Ok işareti için yer aç */
    }
    
    th.sortable::after {
        content: '⇅';
        position: absolute;
        right: 5px;
        opacity: 0.5;
    }
    
    th.sortable.asc::after {
        content: '↑';
        opacity: 1;
    }
    
    th.sortable.desc::after {
        content: '↓';
        opacity: 1;
    }
    </style>

    <table id="pluginTable">
        <thead>
            <tr>
                <th>İkon</th>
                <th class="sortable" data-sort="name">Ad</th>
                <th class="sortable" data-sort="repoCodes">Depo Kodu</th>
                <th class="sortable" data-sort="tvTypes">Tür</th>
                <th class="sortable" data-sort="description">Açıklama</th>
                <th class="sortable" data-sort="language">Dil</th>
                <th class="sortable" data-sort="version">Ver.</th>
            </tr>
        </thead>
        <tbody></tbody>
    </table>

    <style>
    /* Yeni eklenti badge'i için stil */
    .new-plugin-badge {
        background-color: #28a745;
        color: white;
        padding: 2px 6px;
        border-radius: 4px;
        font-size: 12px;
        margin-left: 8px;
        font-weight: bold;
        animation: pulse 2s infinite;
    }

    @keyframes pulse {
        0% { opacity: 1; }
        50% { opacity: 0.6; }
        100% { opacity: 1; }
    }
    </style>

    <script>
    function fetchPlugins() {
        fetch("https://GitLatte.github.io/repos/data.json")
        .then(response => {
            if (!response.ok) {
                throw new Error(`HTTP hatası: ${response.status}`);
            }
            return response.json();
        })
        .then(data => {
            console.log("Çekilen Veri:", data);

            let pluginList = null;
            let lastUpdatedTimestamp = null;

            if (data && Array.isArray(data.plugins)) {
                pluginList = data.plugins;
                lastUpdatedTimestamp = data.timestamp;
                console.log("Veri obje formatında algılandı.");
            } else if (Array.isArray(data)) {
                pluginList = data;
                lastUpdatedTimestamp = null;
                console.log("Veri dizi formatında algılandı.");
            } else {
                console.error("Hata: Çekilen veri beklenen formatta değil.", data);
                document.getElementById("totalPlugins").textContent = "Veri yüklenemedi.";
                document.getElementById("totalRepos").textContent = "";
                document.getElementById("lastUpdated").textContent = "Son Güncelleme: Hata";
                document.getElementById("filterSelect").innerHTML = '<option value="all">Veri Yok</option>';
                document.getElementById("repoFilterSelect").innerHTML = '<option value="all">Veri Yok</option>';
                document.querySelector("#pluginTable tbody").innerHTML = '<tr><td colspan="7">Eklenti verisi yüklenemedi veya formatı yanlış.</td></tr>';
                window.pluginData = { plugins: [], timestamp: null };
                return;
            }

            if (pluginList !== null) {
                // Son 7 gün içinde eklenen eklentileri işaretle
                const oneWeekAgo = new Date();
                oneWeekAgo.setDate(oneWeekAgo.getDate() - 7);
                
                pluginList.forEach(plugin => {
    // --- YENİ EKLENTİ (createdAt alanı varsa ve 48 saatten küçükse) --- 
    // Bu kısım fetch_plugins.py'den gelen isNew bayrağını kullanabilir veya createdAt'a göre yeniden hesaplayabiliriz.
    // Şimdilik fetch_plugins.py'den gelen isNew'ı kullanmaya devam edelim.
    // ancak gösterim süresini index.html'de kontrol edelim.
    
    // --- HER REPO İÇİN GÜNCELLEME BAYRAĞI (repoTimestamps varsa) ---
    // repoUpdated = {repoKodu: true/false, ...}
    plugin.repoUpdated = {};
    if (plugin.repoTimestamps) {
        const now = new Date();
        // Belirli bir gün sayısı kadar yeni/güncel kabul et
        const RECENT_THRESHOLD_DAYS = 7; // Örneğin 7 gün
        const recentThresholdMs = RECENT_THRESHOLD_DAYS * 24 * 60 * 60 * 1000;

        for (const repo in plugin.repoTimestamps) {
            const ts = new Date(plugin.repoTimestamps[repo]);
            plugin.repoUpdated[repo] = ((now - ts) < recentThresholdMs);
        }
    }

    // Yetişkin içerik kontrolü ve sansürleme (varsa)
    if (plugin.tvTypes && plugin.tvTypes.some(type => type.toLowerCase() === 'nsfw')) {
        plugin.name = '[Yetişkin İçeriği]';
        plugin.description = '[Yetişkin İçeriği]';
    }
});

                window.pluginData = {
                    plugins: pluginList,
                    timestamp: lastUpdatedTimestamp
                };

                updateStats("all");
                updateFilterOptions();
                updateRepoOptions();
                updateTable("all", "all", "");
                updateLastUpdated();
            }
        })
        .catch(error => {
            console.error("JSON verisi yüklenemedi:", error);
            document.getElementById("totalPlugins").textContent = "Veri yüklenemedi.";
            document.getElementById("totalRepos").textContent = "";
            document.getElementById("lastUpdated").textContent = "Son Güncelleme: Hata";
            document.getElementById("filterSelect").innerHTML = '<option value="all">Veri Yok</option>';
            document.getElementById("repoFilterSelect").innerHTML = '<option value="all">Veri Yok</option>';
            document.querySelector("#pluginTable tbody").innerHTML = '<tr><td colspan="7">Eklenti verisi yüklenemedi veya formatı yanlış.</td></tr>';
            window.pluginData = { plugins: [], timestamp: null };
        });
    }

    function updateFilterOptions() {
        if (!window.pluginData || !Array.isArray(window.pluginData.plugins)) {
            document.getElementById("filterSelect").innerHTML = '<option value="all">Veri Yok</option>';
            return;
        }

        const mediaTypeTranslations = {
            // Ana medya türleri
            "tvseries": "Dizi",
            "tv series": "Dizi",
            "tv-series": "Dizi",
            "series": "Dizi",
            "dizi": "Dizi",
            
            "anime": "Anime",
            "animeova": "Anime",
            "anime ova": "Anime",
            "anime-ova": "Anime",
            
            "movie": "Film",
            "film": "Film",
            "movies": "Film",
            "films": "Film",
            
            "animemovie": "Anime Filmi",
            "anime movie": "Anime Filmi",
            "anime-movie": "Anime Filmi",
            
            "asiandrama": "Asya Dizisi",
            "asian drama": "Asya Dizisi",
            "asian-drama": "Asya Dizisi",
            
            // Diğer medya türleri
            "podcast": "Podcast",
            "ova": "OVA (Özel Video Animasyon)",
            "cartoon": "Çizgi Film",
            "documentary": "Belgesel",
            "short": "Kısa Film",
            "music": "Müzik",
            "live": "Canlı Yayın",
            "nsfw": "Yetişkin İçeriği",
            "others": "Diğer"
        };

        // Benzersiz medya türlerini topla ve normalleştir
        const uniqueTypes = new Set();
        window.pluginData.plugins.forEach(plugin => {
            if (plugin.tvTypes) {
                plugin.tvTypes.forEach(type => {
                    const normalizedType = type.toLowerCase().trim();
                    // Eğer bu tür için bir çeviri varsa, ana türü kullan
                    const translatedType = mediaTypeTranslations[normalizedType];
                    if (translatedType) {
                        // Türkçe karşılığına göre grupla
                        const mainType = Object.entries(mediaTypeTranslations).find(([_, value]) => value === translatedType)?.[0] || normalizedType;
                        uniqueTypes.add(mainType);
                    } else {
                        uniqueTypes.add(normalizedType);
                    }
                });
            }
        });

        // Medya türlerini alfabetik sırala
        const sortedTypes = Array.from(uniqueTypes).sort((a, b) => {
            const aText = mediaTypeTranslations[a] || a;
            const bText = mediaTypeTranslations[b] || b;
            return aText.localeCompare(bText, 'tr');
        });

        // Seçenekleri oluştur
        let options = '<option value="all">Tüm Eklentiler</option>';
        sortedTypes.forEach(type => {
            const displayText = mediaTypeTranslations[type] || type;
            options += `<option value="${type}">${displayText}</option>`;
        });

        document.getElementById("filterSelect").innerHTML = options;
    }

    function normalizeMediaType(type) {
        const normalized = type.toLowerCase().trim();
        // Alternatif yazımları kontrol et ve ana türe dönüştür
        if (normalized.includes('tv') && normalized.includes('series')) return 'tvseries';
        if (normalized.includes('anime') && normalized.includes('ova')) return 'animeova';
        if (normalized.includes('anime') && normalized.includes('movie')) return 'animemovie';
        if (normalized.includes('asian') && (normalized.includes('drama') || normalized.includes('dizi'))) return 'asiandrama';
        return normalized;
    }

    function updateRepoOptions() {
        if (!window.pluginData || !Array.isArray(window.pluginData.plugins)) {
            document.getElementById("repoFilterSelect").innerHTML = '<option value="all">Veri Yok</option>';
            return;
        }

        // Benzersiz depo kodlarını topla
        const uniqueRepos = new Set();
        window.pluginData.plugins.forEach(plugin => {
            if (plugin.repoCodes) {
                plugin.repoCodes.forEach(repo => uniqueRepos.add(repo));
            }
        });

        // Depo kodlarını alfabetik sırala
        const sortedRepos = Array.from(uniqueRepos).sort();

        // Seçenekleri oluştur
        let options = '<option value="all">Tüm Depolar</option>';
        sortedRepos.forEach(repo => {
            options += `<option value="${repo}">${repo}</option>`;
        });

        document.getElementById("repoFilterSelect").innerHTML = options;
    }

    function updateStats(repoFilter) {
        if (!window.pluginData || !Array.isArray(window.pluginData.plugins)) {
            document.getElementById("totalPlugins").textContent = "Toplam Eklenti: 0";
            document.getElementById("totalRepos").textContent = "Toplam Depo: 0";
            return;
        }

        let filteredPlugins = window.pluginData.plugins;
        if (repoFilter !== "all") {
            filteredPlugins = filteredPlugins.filter(plugin => 
                plugin.repoCodes && plugin.repoCodes.includes(repoFilter)
            );
        }

        // Toplam eklenti sayısı
        document.getElementById("totalPlugins").textContent = 
            `Toplam Eklenti: ${filteredPlugins.length}`;

        // Benzersiz depo sayısı
        const uniqueRepos = new Set();
        window.pluginData.plugins.forEach(plugin => {
            if (plugin.repoCodes) {
                plugin.repoCodes.forEach(repo => uniqueRepos.add(repo));
            }
        });
        document.getElementById("totalRepos").textContent = 
            `Toplam Depo: ${uniqueRepos.size}`;
    }

    function updateLastUpdated() {
        if (!window.pluginData || !window.pluginData.timestamp) {
            document.getElementById("lastUpdated").textContent = "Son Güncelleme: Bilinmiyor";
            return;
        }

        const lastUpdate = new Date(window.pluginData.timestamp);
        const now = new Date();
        const diffInMinutes = Math.floor((now - lastUpdate) / (1000 * 60));

        let timeText;
        if (diffInMinutes < 1) {
            timeText = "az önce";
        } else if (diffInMinutes < 60) {
            timeText = `${diffInMinutes} dakika önce`;
        } else if (diffInMinutes < 1440) {
            const hours = Math.floor(diffInMinutes / 60);
            timeText = `${hours} saat önce`;
        } else {
            const days = Math.floor(diffInMinutes / 1440);
            timeText = `${days} gün önce`;
        }

        document.getElementById("lastUpdated").textContent = `Son Güncelleme: ${timeText}`;
    }

    // Diğer kodlar buraya gelecek...
    let currentSort = {
        column: null,
        direction: 'asc'
    };

    function initSortableTable() {
        const headers = document.querySelectorAll('th.sortable');
        headers.forEach(header => {
            header.addEventListener('click', () => {
                const column = header.dataset.sort;
                
                // Sıralama yönünü değiştir
                if (currentSort.column === column) {
                    currentSort.direction = currentSort.direction === 'asc' ? 'desc' : 'asc';
                } else {
                    currentSort.column = column;
                    currentSort.direction = 'asc';
                }
                
                // Ok işaretlerini güncelle
                headers.forEach(h => h.classList.remove('asc', 'desc'));
                header.classList.add(currentSort.direction);
                
                // Tabloyu yeniden sırala ve güncelle
                const filterType = document.getElementById('filterSelect').value;
                const repoFilter = document.getElementById('repoFilterSelect').value;
                const searchQuery = document.getElementById('searchInput').value;
                updateTable(filterType, repoFilter, searchQuery);
            });
        });
    }

    function updateTable(filterType, repoFilter, searchQuery) {
        if (!window.pluginData || !Array.isArray(window.pluginData.plugins)) {
            const tableBody = document.querySelector("#pluginTable tbody");
            tableBody.innerHTML = '<tr><td colspan="7">Eklenti verisi yüklenemedi veya formatı yanlış.</td></tr>';
            return;
        }

        const tableBody = document.querySelector("#pluginTable tbody");
        tableBody.innerHTML = "";

        const mediaTypeTranslations = {
            "podcast": "Podcast",
            "tvseries": "Dizi",
            "anime": "Anime",
            "ova": "OVA (Özel Video Animasyon)",
            "cartoon": "Çizgi Film",
            "documentary": "Belgesel",
            "short": "Kısa Film",
            "music": "Müzik",
            "live": "Canlı Yayın",
            "nsfw": "Yetişkin İçeriği",
            "others": "Diğer",
            "asiandrama": "Asya Dizisi",
            "animemovie": "Anime Filmi",
            "animeova": "Anime",
            "movie": "Film"
        };

        // Sıralama fonksiyonu
        function sortPlugins(plugins) {
            return plugins.sort((a, b) => {
                // Önce yeni eklentileri üste taşı
                if (a.isNew !== b.isNew) {
                    return b.isNew ? 1 : -1;
                }
                
                // Sonra seçilen kolona göre sırala
                if (currentSort.column) {
                    let aVal = a[currentSort.column];
                    let bVal = b[currentSort.column];
                    
                    // Özel sıralama kuralları
                    if (currentSort.column === 'repoCodes') {
                        aVal = aVal ? aVal.join(',') : '';
                        bVal = bVal ? bVal.join(',') : '';
                    } else if (currentSort.column === 'tvTypes') {
                        aVal = aVal ? aVal.map(t => mediaTypeTranslations[t.toLowerCase()] || t).join(',') : '';
                        bVal = bVal ? bVal.map(t => mediaTypeTranslations[t.toLowerCase()] || t).join(',') : '';
                    } else if (currentSort.column === 'version') {
                        aVal = parseFloat(aVal) || 0;
                        bVal = parseFloat(bVal) || 0;
                    }
                    
                    if (aVal === bVal) return 0;
                    
                    const comparison = aVal > bVal ? 1 : -1;
                    return currentSort.direction === 'asc' ? comparison : -comparison;
                }
                return 0;
            });
        }

        let filteredPlugins = window.pluginData.plugins
            .filter(plugin => {
                if (filterType !== "all") {
                    if (!plugin.tvTypes) return false;
                    // Her bir medya türünü normalize et ve karşılaştır
                    const normalizedFilterType = normalizeMediaType(filterType);
                    return plugin.tvTypes.some(type => normalizeMediaType(type) === normalizedFilterType);
                }
                if (repoFilter !== "all" && (!plugin.repoCodes || !plugin.repoCodes.includes(repoFilter))) return false;
                if (searchQuery && !plugin.name.toLowerCase().includes(searchQuery.toLowerCase())) return false;
                return true;
            });

        // Sıralama uygula
        filteredPlugins = sortPlugins(filteredPlugins);

        filteredPlugins.forEach(plugin => {
            const row = document.createElement("tr");
            const iconCell = document.createElement("td");
            const nameCell = document.createElement("td");
            const repoCell = document.createElement("td");
            const typeCell = document.createElement("td");
            const descCell = document.createElement("td");
            const langCell = document.createElement("td");
            const verCell = document.createElement("td");

            // İkon hücresi
            const icon = document.createElement("img");
            icon.src = plugin.iconUrl ? plugin.iconUrl.replace("%size%", "32") : "";
            icon.width = 32;
            icon.height = 32;
            iconCell.appendChild(icon);

            // İsim hücresi - Yeni eklenti badge'i ekle
            nameCell.textContent = plugin.name;
            
            // Yeni ve Güncellendi ibareleri için zaman tabanlı kontrol
            const RECENT_THRESHOLD_DAYS_FOR_BADGE = 7; // Badge'in görünür kalacağı gün sayısı
            const now = new Date();

            let showNewBadge = false;
            if (plugin.createdAt) {
                const createdAtDate = new Date(plugin.createdAt);
                if ((now - createdAtDate) < RECENT_THRESHOLD_DAYS_FOR_BADGE * 24 * 60 * 60 * 1000) {
                    showNewBadge = true;
                }
            }

            let showUpdatedBadge = false;
            if (plugin.repoTimestamps) {
                for (const repo in plugin.repoTimestamps) {
                    const ts = new Date(plugin.repoTimestamps[repo]);
                    if ((now - ts) < RECENT_THRESHOLD_DAYS_FOR_BADGE * 24 * 60 * 60 * 1000) {
                        showUpdatedBadge = true;
                        break; // Bir depo bile güncelse yeterli
                    }
                }
            }

            if (showNewBadge) {
                const newBadge = document.createElement("span");
                newBadge.textContent = "Yeni";
                newBadge.className = "plugin-status-badge new-plugin-badge";
                nameCell.appendChild(newBadge);
            } else if (showUpdatedBadge) { // Sadece yeni değilse güncellendi göster
                const updatedBadge = document.createElement("span");
                updatedBadge.textContent = "Güncellendi";
                updatedBadge.className = "plugin-status-badge updated-plugin-badge";
                nameCell.appendChild(updatedBadge);
            }

            // Yetişkin içerik kontrolü
            const isNSFW = plugin.tvTypes && plugin.tvTypes.some(type => type.toLowerCase() === 'nsfw');
            if (isNSFW) {
                icon.style.filter = 'blur(5px)';
                nameCell.style.filter = 'blur(5px)';
                descCell.style.filter = 'blur(5px)';
                
                // Hover ile blur'ı kaldır
                [icon, nameCell, descCell].forEach(element => {
                    element.addEventListener('mouseover', () => element.style.filter = 'none');
                    element.addEventListener('mouseout', () => element.style.filter = 'blur(5px)');
                });
            }

            // Diğer hücreler
            repoCell.innerHTML = (plugin.repoCodes || []).map(repo => {
                // Güncellendi simgesi ekle (repo bazında)
                let updatedIcon = "";
                if (plugin.repoUpdated && plugin.repoUpdated[repo]) { // repoUpdated zaten 7 günlük eşiğe göre hesaplanıyor
                    updatedIcon = '<span title="Bu depoda güncellendi" style="margin-left:4px;color:#28a745;font-weight:bold;">&#8635;</span>'; // Güncelleme simgesi
                }
                return `<span class="repo-badge repo-${repo.toLowerCase()}">${repo}${updatedIcon}</span>`;
            }).join(" ");

            typeCell.textContent = (plugin.tvTypes || []).map(type => 
                mediaTypeTranslations[type.toLowerCase()] || type
            ).join(", ");

            descCell.textContent = plugin.description || "";
            langCell.textContent = plugin.language || "";
            verCell.textContent = plugin.version || "";

            row.appendChild(iconCell);
            row.appendChild(nameCell);
            row.appendChild(repoCell);
            row.appendChild(typeCell);
            row.appendChild(descCell);
            row.appendChild(langCell);
            row.appendChild(verCell);

            tableBody.appendChild(row);
        });
    }

    // Sayfa yüklendiğinde sıralama özelliğini aktifleştir
    document.addEventListener('DOMContentLoaded', initSortableTable);

    // Event Listener'ları ekleyelim
    document.getElementById("filterSelect").addEventListener("change", function() {
        const repoFilter = document.getElementById("repoFilterSelect").value;
        const searchQuery = document.getElementById("searchInput").value;
        updateTable(this.value, repoFilter, searchQuery);
        updateLastUpdated(); // Filtreleme değişince tarih sabit kalmalı, tekrar güncellemiyoruz
    });

    document.getElementById("repoFilterSelect").addEventListener("change", function() {
        const selectedRepo = this.value;
        updateStats(selectedRepo); // Sadece istatistikleri günceller
        const filterType = document.getElementById("filterSelect").value;
        const searchQuery = document.getElementById("searchInput").value;
        updateTable(filterType, selectedRepo, searchQuery); // Tabloyu günceller
        updateLastUpdated(); // Depo değişince tarih sabit kalmalı, tekrar güncellemiyoruz
    });

    document.getElementById("searchInput").addEventListener("input", function() {
        const filterType = document.getElementById("filterSelect").value;
        const repoFilter = document.getElementById("repoFilterSelect").value;
        updateTable(filterType, repoFilter, this.value);
        updateLastUpdated(); // Arama değişince tarih sabit kalmalı, tekrar güncellemiyoruz
    });

    document.getElementById("clearSearch").addEventListener("click", function() {
        document.getElementById("searchInput").value = "";
        const filterType = document.getElementById("filterSelect").value;
        const repoFilter = document.getElementById("repoFilterSelect").value;
        updateTable(filterType, repoFilter, "");
        updateLastUpdated(); // Arama temizlenince tarih sabit kalmalı, tekrar güncellemiyoruz
    });

    // Sayfa yüklendiğinde veriyi çek
    fetchPlugins();
    </script>
</body>
</html>
